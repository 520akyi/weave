#!/bin/bash

set -eu

# openssl enc -in weavenetci-key.pem -aes256 -a -pass pass:$1

mkdir -p $HOME/.ssh/
KEY_FILE="$HOME/.ssh/weavenetci-key"
rm -f $KEY_FILE
PWD="$1"

openssl enc -out $KEY_FILE -d -aes256 -a -pass pass:"$PWD" << EOF
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
EOF

chmod 400 $KEY_FILE
